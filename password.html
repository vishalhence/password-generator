<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Secure Password Generator</title>
  <style>
    body {
      margin: 0;
      font-family: system-ui, sans-serif;
      background: #0f172a;
      color: #e5e7eb;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .app {
      width: 100%;
      max-width: 460px;
      background: #020617;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.45);
    }
    h1 { margin-top: 0; }
    label { display: flex; justify-content: space-between; margin: 8px 0; }
    input[type="range"] { width: 100%; }
    button {
      width: 100%;
      padding: 12px;
      margin-top: 10px;
      border-radius: 10px;
      border: none;
      background: #1e293b;
      color: #e5e7eb;
      font-size: 1rem;
      cursor: pointer;
    }
    button:hover { background: #000000; }
    .output {
      background: #004cfc;
      padding: 12px;
      border-radius: 10px;
      margin: 12px 0;
      word-break: break-all;
      font-family: monospace;
    }
    .strength { font-weight: 600; }
    .weak { color: #dc2626; }
    .medium { color: #f59e0b; }
    .strong { color: #16a34a; }
    .note { font-size: 0.85rem; opacity: 0.8; }
  </style>
</head>
<body>

<div class="app">
  <h1>Password Generator</h1>

  <label>Password Length: <span id="lenVal">12</span></label>
  <input type="range" min="8" max="32" value="12" id="length" />

  <label><span>Uppercase (A–Z)</span><input type="checkbox" id="upper" checked></label>
  <label><span>Lowercase (a–z)</span><input type="checkbox" id="lower" checked></label>
  <label><span>Numbers (0–9)</span><input type="checkbox" id="numbers" checked></label>
  <label><span>Special Characters</span><input type="checkbox" id="symbols" checked></label>
  <label><span>Avoid Ambiguous (O/0, l/1)</span><input type="checkbox" id="ambiguous" checked></label>

  <div class="output" id="password">Click Generate</div>
  <div class="strength" id="strength"></div>
  <div class="note" id="explain"></div>

  <button onclick="generate()">Generate Password</button>
  <button onclick="copyPassword()">Copy to Clipboard</button>
</div>

<script>
const sets = {
  upper: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
  lower: 'abcdefghijklmnopqrstuvwxyz',
  numbers: '0123456789',
  symbols: '!@#$%^&*()-_=+[]{};:,.<>?'
};

const ambiguousChars = /[O0Il1]/g;

const lengthInput = document.getElementById('length');
const lenVal = document.getElementById('lenVal');
const passwordEl = document.getElementById('password');
const strengthEl = document.getElementById('strength');
const explainEl = document.getElementById('explain');

lengthInput.oninput = () => lenVal.textContent = lengthInput.value;

function secureRandom(max) {
  const arr = new Uint32Array(1);
  window.crypto.getRandomValues(arr);
  return arr[0] % max;
}

function generate() {
  const length = Number(lengthInput.value);
  const selected = [];

  if (upper.checked) selected.push(sets.upper);
  if (lower.checked) selected.push(sets.lower);
  if (numbers.checked) selected.push(sets.numbers);
  if (symbols.checked) selected.push(sets.symbols);

  if (length < 8 || selected.length === 0) {
    passwordEl.textContent = 'Invalid configuration';
    return;
  }

  let password = '';

  selected.forEach(set => {
    password += set[secureRandom(set.length)];
  });

  const allChars = selected.join('');

  while (password.length < length) {
    password += allChars[secureRandom(allChars.length)];
  }

  password = shuffle(password.split('')).join('');

  if (ambiguous.checked) {
    password = password.replace(ambiguousChars, () => allChars[secureRandom(allChars.length)]);
  }

  passwordEl.textContent = password;
  evaluateStrength(password, selected.length);
}

function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = secureRandom(i + 1);
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

function evaluateStrength(pwd, categories) {
  let score = pwd.length + categories * 4;

  if (score < 20) {
    strengthEl.textContent = 'Weak';
    strengthEl.className = 'strength weak';
    explainEl.textContent = 'Too short or limited character variety.';
  } else if (score < 30) {
    strengthEl.textContent = 'Medium';
    strengthEl.className = 'strength medium';
    explainEl.textContent = 'Decent length but could use more character diversity.';
  } else {
    strengthEl.textContent = 'Strong';
    strengthEl.className = 'strength strong';
    explainEl.textContent = 'Long, random, and uses multiple character categories.';
  }
}

function copyPassword() {
  navigator.clipboard.writeText(passwordEl.textContent);
}
</script>
</body>
</html>